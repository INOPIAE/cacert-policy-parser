<!Doctype html>
<html style="background-color: #ccc">
<head><title>CAcert Policy Cleaning Proposal</title></head>
<body style="max-width: 800px; margin: auto; background-color: #fff; padding: 30px; margin-top: 40px">
<h1>CAcert Policy Cleaning Proposal</h1>
<p>
Currently CAcerts policies are managed by many people writing differently-styled and differently-valid html source.
The vote, if a policy document is going to be changed is based upon a HTML-document/HTML-source.
</p>
<p>
This page aims to give you an overview of what the change is going to be, if it is accepted. The proposal is to replace that HTML with a Markdown-like syntax that is then transformed to HTML for display. An overview of the syntax is available <a href="https://github.com/yellowant/cacert-policy-parser/tree/master/syntax.txt">here</a>.
</p>
<p>
The best impression of what the new policy-files would look like might be by looking at the <a href='policy'>generated HTML files</a> directly.
From this new "index"-page you can navigate directly to all Policy Documents, that have been already converted (that are at least AP, CCA, CCS, DRP, OAP and PoP).
</p>
<p>
The source of these documents can be found <a href="https://github.com/yellowant/cacert-policy-parser/tree/master/policyText">here</a>.
This is going to be the content that PolG votes on.
</p>
<p>
In order to help you understand what exactly changes on a character level, we prepared diffs.
We stripped the HTML of both the new and the old HTML-documents and re-formatted the text (e.g. removing spaces, newlines, etc).
Then we did a word-diff between those two document sets. You can see the result in the ".diff.html"-files <a href="old">here</a>.
You can also run that diff by yourself by cloning <a href="https://github.com/yellowant/cacert-policy-parser">https://github.com/yellowant/cacert-policy-parser</a>
and running "org.cacert.policy.GenerateDiffs" after having run "org.cacert.policy.PolicyGenerator", when you have "wdiff" installed.

If you'd only like to have a look on the stripping/reformating-tool, you can take a look <a href="https://github.com/yellowant/cacert-policy-parser/tree/master/src/test/java/org/cacert/policy/GenerateDiffs.java">here</a>.
</p>
<p>
With this proposal come content-changes to the PoP. Those changes are not yet made. You can look them up in the <a href="https://github.com/yellowant/cacert-policy-parser/tree/master/policyText/PoP.txt">new Policy File Format</a>, see the <a href="old/PoP.diff.html">diff the old PoP text-wise</a>, or look at the <a href="policy/PoP.html">proposed new PoP</a>.
</p>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="width: 100%; height:700px">
    <marker id="triangle"
      viewBox="0 0 10 10" refX="10" refY="5" 
      markerUnits="userSpaceOnUse"
      markerWidth="40" markerHeight="30"
      orient="auto">
      <path d="M 0 0 L 10 5 L 0 10" fill="none" stroke="black" />
    </marker>

<style type="text/css">
text{
  fill:black;
  text-anchor: middle;
}
ellipse {
  stroke:black;
  fill:white;
}
line{
  stroke-width:1;
}
a {
  fill: blue;
  text-decoration: underline;
}
a:visited{
  fill: #4400aa;
}
</style>
<line x1="130" y1="200" x2="470" y2="120" marker-end="url(#triangle)" stroke="black"/>
<text x="300" y="160">Hand-transformation</text>

<line x1="600" y1="100" x2="600" y2="210" marker-end="url(#triangle)" stroke="black"/>
<text x="600" y="165"><a xlink:href="https://github.com/yellowant/cacert-policy-parser/tree/master/">Policy-tool</a></text>

<line x1="130" y1="200" x2="130" y2="360" marker-end="url(#triangle)" stroke="black"/>
<text x="130" y="280"><a xlink:href="https://github.com/yellowant/cacert-policy-parser/blob/master/src/test/java/org/cacert/policy/GenerateDiffs.java">Stripping-tool</a></text>
<line x1="600" y1="250" x2="600" y2="360" marker-end="url(#triangle)" stroke="black"/>
<text x="600" y="320"><a xlink:href="https://github.com/yellowant/cacert-policy-parser/blob/master/src/test/java/org/cacert/policy/GenerateDiffs.java">Stripping-tool</a></text>

<line x1="130" y1="400" x2="300" y2="513" marker-end="url(#triangle)" stroke="black"/>
<line x1="600" y1="400" x2="450" y2="515" marker-end="url(#triangle)" stroke="black"/>

<ellipse cx="130" cy="200" rx="120" ry="40"/>
<text x="130" y="200"><a xlink:href="https://www.cacert.org/policy/">Old Documents (.html)</a></text>

<ellipse cx="130" cy="400" rx="120" ry="40"/>
<text x="130" y="400"><a xlink:href="old">Old Documents, stripped (.old.txt)</a></text>


<ellipse cx="600" cy="100" rx="150" ry="40"/>
<text x="600" y="100"><a xlink:href="https://github.com/yellowant/cacert-policy-parser/blob/master/policyText">New Documents (.txt)</a></text>

<ellipse cx="600" cy="250" rx="150" ry="40"/>
<text x="600" y="250"><a xlink:href="policy">New generated Documents (.html)</a></text>

<ellipse cx="600" cy="400" rx="150" ry="40"/>
<text x="600" y="400">
<a xlink:href="old">
    <tspan x="600" dy="0">New generated Documents,</tspan>
    <tspan x="600" dy="1.2em">stripped.new.txt</tspan>
</a>
</text>

<ellipse cx="370" cy="550" rx="150" ry="40"/>
<text x="370" y="550"><a xlink:href="old">Deltas (.diff.html)</a></text>


</svg>
<h4>Proposed new Policy workflow</h4>
<p>
This restructuring of the policy documents is also intended to clean up the policy workflow. The new (cleaned) workflow could look like this:

<ol>
<li>Persons wishing changes in policy documents may:
<ol>
<li>Fork the git repository of the policies, make their changes and send that (github link, patch file, etc.) to the mailing list, or ..</li>
<li>.. ask for those changes on the mailing list directly and the PolO will create the commits.</li>
</ol>
</li>
<li>When there is a decision to be made (i.e. by rough consensus or by a vote), the two commits (base and proposed new base) and a diff between them can be sent to clarify what the changes are.</li>
<li>When the decision is made, the resulting commit will be tagged with a label indicating the corresponding policy decision.</li>
<li>In order to deploy the new documents a Jenkins instance might be used to re-create the .html documents, commit them into the "policy.cacert.org"-repository and push that onto the server.</li>
</ol>
This new process helps to clearly identify all modifications and to have a publicly documented history of all changes to the policy documents.
</p>
</body>
</html>
